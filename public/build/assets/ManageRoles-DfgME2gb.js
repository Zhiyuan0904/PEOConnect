import{u as B,r as d,s as T,o as P,l as Q,c as o,b as e,f as g,m as G,g as p,v as _,F as w,z as k,w as H,h as R,d as I,t as u,j as f,e as r}from"./app-CLQc5iUQ.js";import{_ as J}from"./Sidebar-BuI_G_lZ.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"flex min-h-screen bg-gradient-to-tr from-[#f4f4f4] to-[#f9fbfd] font-sans"},W={class:"w-1/5 fixed h-screen z-40"},X={class:"ml-[20%] w-[80%] relative"},Y={class:"p-10 z-10 relative"},Z={class:"w-full max-w-6xl bg-white rounded-2xl shadow-xl p-10 mx-auto"},ee={class:"mb-4 flex justify-end"},te={key:0,class:"text-center text-gray-400 py-10"},se={key:1},ae={class:"min-w-full text-sm border border-[#e3e3e3]"},le={class:"py-3 px-4"},oe={class:"py-3 px-4"},re={class:"py-3 px-4"},ne=["onUpdate:modelValue"],de=["value"],ie={class:"py-3 px-4 text-center"},ce={class:"flex justify-center items-center space-x-2"},ue=["onClick"],me=["onClick"],pe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40"},fe={class:"bg-white rounded-2xl shadow-xl p-8 w-full max-w-3xl"},ve={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},be=["value"],xe={class:"flex justify-end gap-3"},ye=["disabled"],he={key:0,class:"tracking-widest"},ge={key:1},_e={key:0,class:"text-red-500 mt-2 text-sm"},we={key:1,class:"text-green-600 mt-2 text-sm"},ke={__name:"ManageRoles",setup(Ue){const V=B(),j=Q(),m=d([]),x=d(!0),M=["admin","lecturer","quality team","dean","student","alumni"],N=["lecturer","quality team","dean"],y=d(""),S=T(()=>{const a=y.value.toLowerCase();return m.value.filter(t=>t.name.toLowerCase().includes(a)||t.email.toLowerCase().includes(a))}),n=d({name:"",email:"",role:""}),v=d(!1),i=d(""),c=d(""),b=d(!1),F=()=>{b.value=!0,c.value="",i.value="",n.value={name:"",email:"",role:""}},q=()=>{b.value=!1,c.value="",i.value=""},z=async()=>{x.value=!0;try{const a=await f.get("/manage/users");m.value=a.data}catch(a){console.error(a)}finally{x.value=!1}},D=async a=>{try{await f.put(`/manage/users/${a.id}/role`,{role:a.role}),alert("Role updated successfully")}catch(t){console.error(t),alert("Failed to update role")}},E=async()=>{var a,t;v.value=!0,i.value="",c.value="";try{const s=await f.post("/manage/users/create",n.value),{email:l,generatedPassword:$}=s.data,U=n.value.name,C=n.value.role;c.value="User created and email sent.",b.value=!1,m.value.push({id:s.data.id||Date.now(),name:U,email:l,role:C,spatie_role:h(C)}),f.post("/manage/users/send-login-email",{email:l,name:U,password:$}).catch(A=>{console.warn("Email failed:",A)})}catch(s){i.value=((t=(a=s.response)==null?void 0:a.data)==null?void 0:t.message)||"Failed to create user."}finally{v.value=!1}},L=async a=>{var t,s;if(confirm("Are you sure you want to delete this user?"))try{await f.delete(`/manage/users/${a}`),m.value=m.value.filter(l=>l.id!==a),alert("User deleted successfully.")}catch(l){console.error("Delete error:",l),alert(((s=(t=l.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to delete user.")}};P(()=>{var a;((a=V.user)==null?void 0:a.role)!=="admin"?j.push("/dashboard"):z()});const h=a=>a.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");return(a,t)=>(r(),o("div",O,[e("div",W,[G(J)]),e("div",X,[t[6]||(t[6]=e("div",{class:"absolute inset-0 flex justify-center items-center pointer-events-none"},[e("div",{class:"w-[550px] h-[550px] md:w-[700px] md:h-[700px] rounded-full blur-[100px] opacity-20 bg-gradient-to-br from-[#e6c752] via-[#d98ab3] to-[#7caee6] animate-floating-glow"})],-1)),e("main",Y,[e("div",Z,[e("div",{class:"flex justify-between items-center mb-8"},[t[4]||(t[4]=e("h1",{class:"text-4xl font-bold text-[#4072bc]"},"Manage User Roles",-1)),e("button",{onClick:F,class:"bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] hover:from-[#8475d2] hover:to-[#a7c8f8] text-white font-semibold px-7 py-3 rounded-full shadow-md transition"}," + Register New User ")]),e("div",ee,[p(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>y.value=s),placeholder:"ðŸ” Search by name or email...",class:"w-full md:w-1/4 px-3 py-2 text-sm border border-gray-300 rounded-full shadow-sm focus:ring-1 focus:ring-[#4072bc] focus:outline-none"},null,512),[[_,y.value]])]),x.value?(r(),o("div",te,"Loading users...")):(r(),o("div",se,[e("table",ae,[t[5]||(t[5]=e("thead",{class:"bg-[#f9fbfd]"},[e("tr",null,[e("th",{class:"py-3 px-4 text-left font-semibold text-[#4072bc] border-b"},"Name"),e("th",{class:"py-3 px-4 text-left font-semibold text-[#4072bc] border-b"},"Email"),e("th",{class:"py-3 px-4 text-left font-semibold text-[#4072bc] border-b"},"Role"),e("th",{class:"py-3 px-4 text-center font-semibold text-[#4072bc] border-b"},"Action")])],-1)),e("tbody",null,[(r(!0),o(w,null,k(S.value,s=>(r(),o("tr",{key:s.id,class:"hover:bg-[#f9fbfd]"},[e("td",le,u(s.name),1),e("td",oe,u(s.email),1),e("td",re,[p(e("select",{"onUpdate:modelValue":l=>s.role=l,class:"border rounded-md px-2 py-1 w-full"},[(r(),o(w,null,k(M,l=>e("option",{key:l,value:l},u(h(l)),9,de)),64))],8,ne),[[R,s.role]])]),e("td",ie,[e("div",ce,[e("button",{onClick:l=>D(s),class:"bg-[#59a8f7] hover:bg-[#3a85c3] text-white font-semibold px-3 py-1 rounded text-xs"},"Update",8,ue),e("button",{onClick:l=>L(s.id),class:"bg-red-400 hover:bg-red-500 text-white font-semibold px-3 py-1 rounded text-xs"},"Delete",8,me)])])]))),128))])])]))])])]),b.value?(r(),o("div",pe,[e("div",fe,[e("div",{class:"flex justify-between items-center mb-6"},[t[7]||(t[7]=e("h2",{class:"text-2xl font-bold text-[#4072bc]"},"Register New User",-1)),e("button",{onClick:q,class:"text-gray-400 hover:text-red-500 text-2xl"},"Ã—")]),e("form",{onSubmit:H(E,["prevent"]),class:"space-y-4"},[e("div",ve,[p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.value.name=s),type:"text",placeholder:"Full Name",class:"border p-2 rounded-full w-full",required:""},null,512),[[_,n.value.name]]),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.value.email=s),type:"email",placeholder:"Email",class:"border p-2 rounded-full w-full",required:""},null,512),[[_,n.value.email]]),p(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.value.role=s),class:"border p-2 rounded-full w-full",required:""},[t[8]||(t[8]=e("option",{disabled:"",value:""},"Select Role",-1)),(r(),o(w,null,k(N,s=>e("option",{key:s,value:s},u(h(s)),9,be)),64))],512),[[R,n.value.role]])]),e("div",xe,[e("button",{type:"submit",disabled:v.value,class:"bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] text-white px-6 py-2 rounded-full shadow-md hover:from-[#8475d2] hover:to-[#a7c8f8] disabled:opacity-50 disabled:cursor-not-allowed"},[v.value?(r(),o("span",he,t[9]||(t[9]=[I("Creating"),e("span",{class:"dot-animate"},"...",-1)]))):(r(),o("span",ge,"Create"))],8,ye)]),i.value?(r(),o("p",_e,u(i.value),1)):g("",!0),c.value?(r(),o("p",we,u(c.value),1)):g("",!0)],32)])])):g("",!0)]))}},je=K(ke,[["__scopeId","data-v-1abe6b2a"]]);export{je as default};
