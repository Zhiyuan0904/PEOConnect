import{r as y,s as z,c as r,m as B,b as t,f as d,F as k,z as q,g as f,v as g,t as b,h as M,j as C,l as D,e as u,n as E}from"./app-BhsT9O-c.js";import{_ as I}from"./Sidebar-rajKNV1F.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"flex ml-[20%] min-h-screen bg-gradient-to-tr from-[#f4f4f4] to-[#f9fbfd]"},G={class:"flex-1 flex items-center justify-center p-10"},H={class:"relative w-full max-w-5xl p-10"},J={class:"relative z-10 bg-white rounded-2xl shadow-lg p-10"},K={class:"flex justify-center mb-12"},W=["onClick"],X={class:"text-sm font-medium"},Y={key:0},Z={class:"mb-8 border-2 border-dashed border-[#59a8f7] bg-[#f9fbfd] rounded-xl p-6 text-center"},ee={key:1},te={key:2},se={key:0,class:"bg-[#f9fbfd] border border-[#e3e3e3] rounded-xl p-6"},oe={class:"flex justify-between items-center mb-4"},le={class:"font-semibold text-[#4072bc] text-lg"},ne={class:"mb-4"},ie={class:"mb-4"},re={key:0},ue=["onUpdate:modelValue"],ae=["onClick"],de={key:3,class:"text-center py-10"},ve={class:"flex justify-between items-center mt-12"},ce=["disabled"],pe={key:4,class:"p-3 bg-red-100 text-red-700 rounded text-sm mt-4"},me={__name:"CreateSurveys",setup(fe){const s=y({title:"",description:"",questions:[]}),x=y(!1),v=y(""),_=D(),o=y(0),S=["Import CSV","Survey Info","Questions","Review"],c=z(()=>s.value.questions.length+3),T=()=>{s.value.questions.push({questionType:"short-answer",questionText:"",options:[]})},V=n=>{s.value.questions.splice(n,1)},$=n=>{s.value.questions[n].options.push("")},Q=(n,e)=>{s.value.questions[n].options.splice(e,1)},U=n=>{n>=0&&n<c.value&&(o.value=n)},j=async()=>{var n,e;try{x.value=!0,v.value="";const l=s.value.title.trim();if(!l){v.value="Survey title is required.";return}const{data:i}=await C.get("/surveys/check-title",{params:{title:l}});if(i.exists){v.value="A survey with this title already exists. Please choose a different title.";return}await C.post("/surveys",{...s.value,title:l}),alert("Survey created successfully!"),_.push("/manage/surveys")}catch(l){v.value=((e=(n=l.response)==null?void 0:n.data)==null?void 0:e.message)||"Failed to create survey"}finally{x.value=!1}},R=n=>{const e=n.target.files[0];if(!e)return;const l=a=>a.replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1").replace(/""/g,'"'),i=new FileReader;i.onload=()=>{const a=i.result.split(`
`).map(p=>p.trim()).filter(p=>p!=="");if(a.length<2){alert("CSV must contain at least 2 rows (header + data)");return}const A=a.slice(1);s.value.title="",s.value.description="",s.value.questions=[],A.forEach((p,F)=>{const m=p.split(",").map(w=>l(w.trim()));F===0&&(s.value.title=m[0]||"",s.value.description=m[1]||"");const N=m[2]||"",h=m[3]||"short-answer",O=m.slice(4).filter(w=>w!=="");s.value.questions.push({questionText:N,questionType:h,options:h==="multiple-choice"?O:[]})})},i.readAsText(e)};return(n,e)=>(u(),r("div",P,[B(I),t("main",G,[t("div",H,[e[19]||(e[19]=t("div",{class:"absolute inset-0 z-0 rounded-1xl blur-3xl opacity-40 bg-gradient-to-br from-[#e6c752] via-[#d98ab3] to-[#7caee6] animate-floating-glow"},null,-1)),t("div",J,[e[18]||(e[18]=t("h1",{class:"text-4xl font-bold text-[#4072bc] mb-10 text-center"},"Create New Survey ðŸ“‹",-1)),t("div",K,[(u(),r(k,null,q(S,(l,i)=>t("div",{key:i,class:"flex flex-col items-center mx-6 cursor-pointer",onClick:a=>U(i)},[t("div",{class:E([o.value===i?"bg-[#4072bc]":"bg-gray-300","rounded-full w-10 h-10 flex items-center justify-center text-white font-bold text-lg mb-1"])},b(i+1),3),t("div",X,b(l),1)],8,W)),64))]),o.value===0?(u(),r("div",Y,[t("div",Z,[e[8]||(e[8]=t("label",{class:"block mb-3 text-lg font-semibold text-[#4072bc]"},"Import Survey CSV (Optional)",-1)),t("input",{type:"file",accept:".csv",onChange:R,class:"mx-auto text-sm file:rounded-lg file:border-none file:bg-[#59a8f7] file:text-white file:py-2 file:px-4 cursor-pointer"},null,32),e[9]||(e[9]=t("p",{class:"text-xs text-gray-500 mt-2"},"Format: title, description, question_text, question_type, option1, option2...",-1))])])):o.value===1?(u(),r("div",ee,[e[10]||(e[10]=t("label",{class:"block mb-2 text-sm font-semibold text-[#4072bc]"},"Survey Title",-1)),f(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.title=l),type:"text",class:"w-full border border-[#e3e3e3] rounded-lg px-4 py-3 mb-6",required:""},null,512),[[g,s.value.title]]),e[11]||(e[11]=t("label",{class:"block mb-2 text-sm font-semibold text-[#4072bc]"},"Survey Description",-1)),f(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.description=l),rows:"3",class:"w-full border border-[#e3e3e3] rounded-lg px-4 py-3"},null,512),[[g,s.value.description]])])):o.value>=2&&o.value<c.value-1?(u(),r("div",te,[s.value.questions[o.value-2]?(u(),r("div",se,[t("div",oe,[t("h3",le,"Question "+b(o.value-1),1),t("button",{onClick:e[2]||(e[2]=l=>V(o.value-2)),class:"text-red-500 text-sm hover:underline"},"Remove")]),t("div",ne,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-[#6c6f73]"},"Question Text",-1)),f(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.questions[o.value-2].questionText=l),type:"text",class:"w-full border border-[#e3e3e3] px-3 py-2 rounded-lg",required:""},null,512),[[g,s.value.questions[o.value-2].questionText]])]),t("div",ie,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-[#6c6f73]"},"Question Type",-1)),f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.questions[o.value-2].questionType=l),class:"w-full border border-[#e3e3e3] px-3 py-2 rounded-lg"},e[13]||(e[13]=[t("option",{value:"short-answer"},"Short Answer",-1),t("option",{value:"multiple-choice"},"Multiple Choice",-1)]),512),[[M,s.value.questions[o.value-2].questionType]])]),s.value.questions[o.value-2].questionType==="multiple-choice"?(u(),r("div",re,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-[#6c6f73]"},"Options",-1)),(u(!0),r(k,null,q(s.value.questions[o.value-2].options,(l,i)=>(u(),r("div",{key:i,class:"flex gap-2 mb-2"},[f(t("input",{"onUpdate:modelValue":a=>s.value.questions[o.value-2].options[i]=a,type:"text",class:"w-full border border-[#e3e3e3] px-3 py-2 rounded-lg",required:""},null,8,ue),[[g,s.value.questions[o.value-2].options[i]]]),t("button",{onClick:a=>Q(o.value-2,i),class:"text-red-400 hover:text-red-600 text-lg rounded-full"},"Ã—",8,ae)]))),128)),t("button",{onClick:e[5]||(e[5]=l=>$(o.value-2)),class:"bg-gray-200 px-4 py-2 rounded-full font-medium text-sm"},"+ Add Option")])):d("",!0)])):d("",!0),t("div",{class:"text-center mt-6"},[t("button",{onClick:T,class:"bg-[#4072bc] text-white px-8 py-3 rounded-full font-semibold"},"+ Add Question")])])):o.value===c.value-1?(u(),r("div",de,e[16]||(e[16]=[t("h2",{class:"text-2xl font-bold text-[#4072bc] mb-4"},"Ready to submit?",-1),t("p",{class:"text-gray-500 mb-8"},"Click submit to save your survey to the system.",-1)]))):d("",!0),t("div",ve,[o.value>0?(u(),r("button",{key:0,onClick:e[6]||(e[6]=l=>o.value--),class:"w-44 py-3 rounded-full bg-gray-300 text-gray-800 font-semibold shadow-lg hover:brightness-110 transition"},"Back")):d("",!0),e[17]||(e[17]=t("div",{class:"flex-1"},null,-1)),o.value<c.value-1?(u(),r("button",{key:1,onClick:e[7]||(e[7]=l=>o.value++),class:"w-44 py-3 rounded-full bg-gradient-to-r from-[#4072bc] to-[#59a8f7] text-white font-semibold shadow-lg hover:brightness-110 transition"},"Next")):d("",!0),o.value===c.value-1?(u(),r("button",{key:2,disabled:x.value,onClick:j,class:"w-44 py-3 bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] hover:from-[#8475d2] hover:to-[#a7c8f8] text-white font-semibold rounded-full shadow-lg hover:brightness-110 transition"},b(x.value?"Creating...":"Create Survey"),9,ce)):d("",!0)]),v.value?(u(),r("div",pe,b(v.value),1)):d("",!0)])])])]))}},ge=L(me,[["__scopeId","data-v-1e9153e3"]]);export{ge as default};
