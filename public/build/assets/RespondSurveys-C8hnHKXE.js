import{u as k,r as f,o as C,c as l,m as V,b as e,F as m,z as y,t as u,w as R,j as x,e as a,g as _,f as U,v as q,A as F}from"./app-BhsT9O-c.js";import{_ as j}from"./survey-BmmmGed4.js";import{_ as A}from"./Sidebar-rajKNV1F.js";const L={class:"flex ml-[20%] min-h-screen bg-gradient-to-tr from-[#f4f4f4] to-[#f9fbfd] relative"},M={class:"flex-1 flex justify-center p-10 relative z-10"},N={class:"w-full max-w-5xl bg-white rounded-2xl shadow-xl p-10"},T={key:0,class:"text-gray-600 text-lg animate-pulse text-center"},z={key:1,class:"text-center text-gray-500"},B={key:2,class:"grid gap-8 md:grid-cols-2"},$=["onClick"],D={class:"text-xl font-bold text-[#4072bc]"},P={class:"text-gray-500 mt-2"},E={key:3,class:"bg-[#f9fbfd] p-8 rounded-2xl border border-[#e3e3e3] shadow"},Y={class:"text-3xl font-bold text-[#4072bc] mb-3"},G={class:"text-gray-500 mb-8"},H={class:"block text-[#1e3a5f] font-semibold text-lg"},I=["onUpdate:modelValue"],J={key:1,class:"space-y-2"},K=["name","value","onUpdate:modelValue"],O={class:"text-gray-700"},Q={class:"flex justify-between items-center mt-10"},te={__name:"RespondSurveys",setup(W){const b=k(),c=f([]),g=f(!0),r=f(null),i=f([]),h=async()=>{var n,t,s;try{const{data:o}=await x.get("/available-surveys");console.log("🔐 User Role:",(n=b.user)==null?void 0:n.role),console.log("📋 All Surveys:",o);const d=(s=(t=b.user)==null?void 0:t.role)==null?void 0:s.toLowerCase();c.value=o.filter(p=>{var v;return((v=p.target_role)==null?void 0:v.toLowerCase())===d}),console.log("✅ Filtered Surveys:",c.value)}catch(o){console.error("❌ Failed to load surveys:",o),alert("Unable to load surveys. Please try again later.")}finally{g.value=!1}},w=n=>{r.value=n,i.value=Array(n.questions.length).fill(null)},S=async()=>{try{await x.post("/survey-responses",{survey_id:r.value.id,responses:i.value}),alert("🎉 Survey submitted successfully!"),r.value=null,i.value=[],await h()}catch(n){console.error("❌ Survey submission failed:",n),alert("Failed to submit survey. Please try again.")}};return C(()=>{h()}),(n,t)=>(a(),l("div",L,[V(A),t[4]||(t[4]=e("div",{class:"absolute inset-0 flex justify-center items-center pointer-events-none z-0"},[e("div",{class:"w-[550px] h-[550px] md:w-[700px] md:h-[700px] rounded-full blur-3xl opacity-50 bg-gradient-to-br from-[#e6c752] via-[#d98ab3] to-[#7caee6] animate-floating-glow"})],-1)),e("main",M,[e("div",N,[t[3]||(t[3]=e("h1",{class:"text-4xl font-bold text-[#4072bc] mb-10 text-center"},"📝 Respond to Survey",-1)),g.value?(a(),l("div",T," Loading available surveys... ")):!c.value.length&&!r.value?(a(),l("div",z," No available surveys right now. ")):r.value?(a(),l("div",E,[e("h2",Y,u(r.value.title),1),e("p",G,u(r.value.description),1),e("form",{onSubmit:R(S,["prevent"]),class:"space-y-6"},[(a(!0),l(m,null,y(r.value.questions,(s,o)=>(a(),l("div",{key:o,class:"space-y-3"},[e("label",H,u(o+1)+". "+u(s.questionText),1),s.questionType==="short-answer"?_((a(),l("input",{key:0,"onUpdate:modelValue":d=>i.value[o]=d,type:"text",placeholder:"Your answer here...",class:"w-full p-3 border border-[#e3e3e3] rounded-lg focus:ring-2 focus:ring-[#4072bc] focus:outline-none",required:""},null,8,I)),[[q,i.value[o]]]):s.questionType==="multiple-choice"?(a(),l("div",J,[(a(!0),l(m,null,y(s.options,(d,p)=>(a(),l("div",{key:p,class:"flex items-center gap-3"},[_(e("input",{type:"radio",name:"question-"+o,value:d,"onUpdate:modelValue":v=>i.value[o]=v,required:"",class:"text-[#4072bc] focus:ring-[#4072bc]"},null,8,K),[[F,i.value[o]]]),e("span",O,u(d),1)]))),128))])):U("",!0)]))),128)),e("div",Q,[e("button",{type:"button",onClick:t[0]||(t[0]=s=>r.value=null),class:"px-6 py-3 rounded-full bg-gray-300 text-gray-800 font-semibold shadow-lg hover:brightness-110 transition"}," Cancel "),t[2]||(t[2]=e("button",{type:"submit",class:"px-6 py-3 bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] hover:from-[#8475d2] hover:to-[#a7c8f8] text-white font-semibold rounded-full shadow-lg hover:brightness-110 transition"}," Submit Survey ",-1))])],32)])):(a(),l("div",B,[(a(!0),l(m,null,y(c.value,s=>(a(),l("div",{key:s.id,class:"bg-white p-8 rounded-2xl border border-[#e3e3e3] shadow-md hover:shadow-lg cursor-pointer transition duration-300 flex flex-col items-center text-center",onClick:o=>w(s)},[t[1]||(t[1]=e("img",{src:j,alt:"Survey",class:"w-24 mb-4"},null,-1)),e("h2",D,u(s.title),1),e("p",P,u(s.description),1)],8,$))),128))]))])])]))}};export{te as default};
