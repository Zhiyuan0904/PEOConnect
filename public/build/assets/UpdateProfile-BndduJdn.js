import{u as U,r as f,s as x,o as D,c as s,m as P,b as t,w as V,f as c,g as u,v as n,t as _,l as S,e as d,j as E}from"./app-CLQc5iUQ.js";import{_ as M}from"./Sidebar-BuI_G_lZ.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h={class:"flex ml-[20%] min-h-screen bg-gradient-to-tr from-[#f4f4f4] to-[#f9fbfd]"},q={class:"flex-1 flex items-center justify-center p-6"},A={class:"w-full max-w-2xl bg-white rounded-2xl shadow-lg p-10"},B=["value"],C={key:0},T={key:1},j=["disabled"],F={key:0},G={key:1},I={key:2,class:"p-3 bg-green-100 text-green-700 rounded text-sm"},L={key:3,class:"p-3 bg-red-100 text-red-700 rounded text-sm"},O={__name:"UpdateProfile",setup(R){const i=U(),w=S(),r=f(!0),p=f(""),m=f(""),a=f({name:"",enroll_date:"",expected_graduate_date:"",actual_graduate_date:"",password:"",password_confirmation:""}),g=x(()=>i.user||{name:"",email:"",role:""}),v=x(()=>{var o;return["admin","dean","lecturer","quality team"].includes((o=i.user)==null?void 0:o.role)}),b=o=>o?new Date(o).toISOString().split("T")[0]:"",y=async()=>{try{r.value=!0,await i.fetchUser();const o=i.user;o&&(a.value.name=o.name||"",v.value||(a.value.enroll_date=o.enroll_date?b(o.enroll_date):"",a.value.expected_graduate_date=o.expected_graduate_date?b(o.expected_graduate_date):"",a.value.actual_graduate_date=o.actual_graduate_date?b(o.actual_graduate_date):""))}catch(o){console.error("Failed to load user",o),w.push("/login")}finally{r.value=!1}},k=async()=>{var o,e;try{if(r.value=!0,m.value="",p.value="",a.value.password&&a.value.password!==a.value.password_confirmation)throw new Error("Password confirmation does not match");const l=new FormData;l.append("name",a.value.name),v.value||(l.append("enroll_date",a.value.enroll_date),l.append("expected_graduate_date",a.value.expected_graduate_date),l.append("actual_graduate_date",a.value.actual_graduate_date)),a.value.password&&l.append("password",a.value.password),await E.post("/profile/update",l,{headers:{"Content-Type":"multipart/form-data"}}),await i.fetchUser(),a.value.password="",a.value.password_confirmation="",p.value="Profile updated successfully!"}catch(l){m.value=((e=(o=l.response)==null?void 0:o.data)==null?void 0:e.message)||l.message}finally{r.value=!1}};return D(()=>{y()}),(o,e)=>(d(),s("div",h,[P(M),t("main",q,[t("div",A,[e[14]||(e[14]=t("div",{class:"flex flex-col items-center mb-8"},[t("h1",{class:"text-3xl font-bold text-[#4072bc]"},"Update Profile")],-1)),t("form",{onSubmit:V(k,["prevent"]),class:"space-y-5"},[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"Name",-1)),u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.name=l),type:"text",class:"w-full border border-[#e3e3e3] rounded-lg px-3 py-2 focus:ring-[#59a8f7]",required:""},null,512),[[n,a.value.name]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"Email",-1)),t("input",{value:g.value.email,type:"email",class:"w-full bg-gray-100 border border-[#e3e3e3] rounded-lg px-3 py-2 cursor-not-allowed",readonly:""},null,8,B)]),v.value?c("",!0):(d(),s("div",C,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"Enroll Date",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.enroll_date=l),type:"date",class:"w-full border border-[#e3e3e3] rounded-lg px-3 py-2",required:""},null,512),[[n,a.value.enroll_date]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"Expected Graduate Date",-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.expected_graduate_date=l),type:"date",class:"w-full border border-[#e3e3e3] rounded-lg px-3 py-2",required:""},null,512),[[n,a.value.expected_graduate_date]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"Actual Graduate Date (Optional)",-1)),u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.actual_graduate_date=l),type:"date",class:"w-full border border-[#e3e3e3] rounded-lg px-3 py-2"},null,512),[[n,a.value.actual_graduate_date]])])])),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"New Password",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.password=l),type:"password",placeholder:"••••••••",class:"w-full border border-[#e3e3e3] rounded-lg px-3 py-2"},null,512),[[n,a.value.password]]),e[12]||(e[12]=t("p",{class:"text-xs text-gray-500 mt-1"},"Leave blank to keep current password",-1))]),a.value.password?(d(),s("div",T,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-[#6c6f73] mb-1"},"Confirm Password",-1)),u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.password_confirmation=l),type:"password",placeholder:"••••••••",class:"w-full border border-[#e3e3e3] rounded-lg px-3 py-2"},null,512),[[n,a.value.password_confirmation]])])):c("",!0),t("div",null,[t("button",{type:"submit",class:"w-full bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] hover:from-[#8475d2] hover:to-[#a7c8f8] text-white font-semibold px-7 py-3 rounded-full transition duration-300 shadow-md",disabled:r.value},[r.value?(d(),s("span",G,"Updating...")):(d(),s("span",F,"Update Profile"))],8,j)]),p.value?(d(),s("div",I,_(p.value),1)):c("",!0),m.value?(d(),s("div",L,_(m.value),1)):c("",!0)],32)])])]))}},J=N(O,[["__scopeId","data-v-7db074d8"]]);export{J as default};
