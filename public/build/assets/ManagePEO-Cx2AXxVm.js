import{_ as h}from"./Sidebar-rajKNV1F.js";import{c as i,m as g,b as t,q as x,f,F as v,z as y,t as n,w,g as u,d as C,v as p,j as r,e as a}from"./app-BhsT9O-c.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P="https://peoconnect.onrender.com/build/assets/peo-BYT-So1n.jpg",_={components:{Sidebar:h},data(){return{peos:[],loading:!1,showModal:!1,editingPEO:null,showCsvModal:!1,csvFile:null,csvUploading:!1,form:{code:"",description:""}}},computed:{sortedPeos(){return[...this.peos].sort((s,e)=>s.code.localeCompare(e.code))}},mounted(){this.fetchPEOs()},methods:{async fetchPEOs(){this.loading=!0;try{const s=await r.get("/peos");this.peos=s.data}catch(s){console.error(s),alert("Failed to fetch PEOs.")}finally{this.loading=!1}},getNextPEOCode(){const s=this.peos.map(c=>parseInt(c.code.replace(/[^0-9]/g,""),10)).filter(c=>!isNaN(c));return`PEO${s.length?Math.max(...s)+1:1}`},openAddModal(){this.editingPEO=null,this.form={code:this.getNextPEOCode(),description:""},this.showModal=!0},openEditModal(s){this.editingPEO=s,this.form={code:s.code,description:s.description},this.showModal=!0},closeModal(){this.showModal=!1},async submitForm(){try{this.editingPEO?(await r.put(`/peos/${this.editingPEO.id}`,this.form),alert("PEO successfully updated!")):(await r.post("/peos",this.form),alert("PEO successfully created!")),this.closeModal(),this.fetchPEOs()}catch(s){console.error(s),alert("Failed to save PEO.")}},async deletePEO(s){if(confirm("Are you sure to delete this PEO?"))try{await r.delete(`/peos/${s}`),this.fetchPEOs()}catch(e){console.error(e),alert("Failed to delete PEO.")}},openCsvModal(){this.showCsvModal=!0},closeCsvModal(){this.showCsvModal=!1},handleCsvFile(s){this.csvFile=s.target.files[0]},async uploadCsv(){if(!this.csvFile){alert("Please select a CSV file.");return}this.csvUploading=!0;try{const s=new FormData;s.append("csv",this.csvFile);const e=await r.post("/peos/bulk-upload",s);alert(`Imported ${e.data.imported}, skipped ${e.data.skipped}`),this.closeCsvModal(),this.fetchPEOs()}catch(s){console.error(s),alert("Failed to upload CSV.")}finally{this.csvUploading=!1}}}},O={class:"flex ml-[20%] min-h-screen bg-gradient-to-tr from-[#f4f4f4] to-[#f9fbfd]"},M={class:"flex-1 p-10"},k={class:"max-w-7xl mx-auto"},F={class:"flex justify-between items-center mb-10"},U={class:"flex gap-4"},N={key:0,class:"text-center text-gray-500 text-lg py-10 animate-pulse"},j={key:1,class:"text-center text-gray-400 text-lg py-10"},S={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},V={class:"p-6 flex-1"},A={class:"text-xl font-bold text-[#4072bc] mb-2"},B={class:"text-gray-600 mb-4"},D={class:"flex justify-between px-4 py-3 bg-[#f9fafb]"},z=["onClick"],T=["onClick"],q={key:3,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},I={class:"bg-white p-10 rounded-2xl w-full max-w-xl shadow-xl"},L={class:"text-2xl font-bold text-[#4072bc] mb-6"},Y={class:"flex justify-end gap-2"},G={type:"submit",class:"px-6 py-3 bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] text-white rounded-full"},H={key:4,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},J={class:"bg-white p-10 rounded-2xl w-full max-w-xl shadow-xl"},K={class:"flex justify-end gap-2"},Q=["disabled"];function R(s,e,c,W,d,l){const m=x("Sidebar");return a(),i("div",O,[g(m),t("main",M,[t("div",k,[t("div",F,[e[9]||(e[9]=t("h1",{class:"text-4xl font-bold text-[#4072bc]"},"Manage PEOs",-1)),t("div",U,[t("button",{onClick:e[0]||(e[0]=(...o)=>l.openAddModal&&l.openAddModal(...o)),class:"px-6 py-3 rounded-full bg-gradient-to-r from-[#f07ba3] to-[#c4a8e3] text-white font-semibold shadow-md"}," + Add PEO "),t("button",{onClick:e[1]||(e[1]=(...o)=>l.openCsvModal&&l.openCsvModal(...o)),class:"px-6 py-3 rounded-full bg-gradient-to-r from-[#34d399] to-[#059669] text-white font-semibold shadow-md"}," Bulk Upload ")])]),d.loading?(a(),i("div",N," Loading PEOs... ")):d.peos.length===0?(a(),i("div",j," No PEOs found. ")):(a(),i("div",S,[(a(!0),i(v,null,y(l.sortedPeos,o=>(a(),i("div",{key:o.id,class:"bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col justify-between"},[e[10]||(e[10]=t("img",{src:P,class:"w-full h-40 object-cover"},null,-1)),t("div",V,[t("h2",A,n(o.code),1),t("p",B,n(o.description),1)]),t("div",D,[t("button",{onClick:b=>l.openEditModal(o),class:"bg-[#59a8f7] text-white py-2 w-24 rounded-lg shadow"}," Edit ",8,z),t("button",{onClick:b=>l.deletePEO(o.id),class:"bg-red-400 text-white py-2 w-24 rounded-lg shadow"}," Delete ",8,T)])]))),128))])),d.showModal?(a(),i("div",q,[t("div",I,[t("h2",L,n(d.editingPEO?"Edit PEO":"Add PEO"),1),t("form",{onSubmit:e[5]||(e[5]=w((...o)=>l.submitForm&&l.submitForm(...o),["prevent"])),class:"space-y-6"},[t("div",null,[e[11]||(e[11]=t("label",{class:"block mb-2 font-semibold text-[#4072bc]"},[C("PEO Code "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>d.form.code=o),type:"text",disabled:"",class:"w-full border p-3 rounded-lg bg-gray-100",maxlength:"10",required:""},null,512),[[p,d.form.code]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block mb-2 font-semibold text-[#4072bc]"},"Description",-1)),u(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>d.form.description=o),rows:"3",class:"w-full border p-3 rounded-lg"},null,512),[[p,d.form.description]])]),t("div",Y,[t("button",{type:"button",onClick:e[4]||(e[4]=(...o)=>l.closeModal&&l.closeModal(...o)),class:"px-6 py-3 bg-gray-300 text-gray-800 rounded-full"}," Cancel "),t("button",G,n(d.editingPEO?"Update":"Create"),1)])],32)])])):f("",!0),d.showCsvModal?(a(),i("div",H,[t("div",J,[e[13]||(e[13]=t("h2",{class:"text-2xl font-bold text-[#059669] mb-6"},"Bulk Upload PEO in CSV",-1)),t("input",{type:"file",onChange:e[6]||(e[6]=(...o)=>l.handleCsvFile&&l.handleCsvFile(...o)),accept:".csv",class:"mb-6 w-full"},null,32),t("div",K,[t("button",{type:"button",onClick:e[7]||(e[7]=(...o)=>l.closeCsvModal&&l.closeCsvModal(...o)),class:"px-6 py-2 bg-gray-300 text-gray-700 rounded-full"}," Cancel "),t("button",{onClick:e[8]||(e[8]=(...o)=>l.uploadCsv&&l.uploadCsv(...o)),disabled:d.csvUploading,class:"px-6 py-2 bg-[#059669] text-white rounded-full"},n(d.csvUploading?"Uploading...":"Upload"),9,Q)])])])):f("",!0)])])])}const ee=E(_,[["render",R]]);export{ee as default};
